<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Upload Dataset - Data Mining App</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-blue-50 to-blue-100 min-h-screen">

    <!-- Navbar -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center">
                    <span class="text-blue-700 font-extrabold text-2xl tracking-wide">Data Mining App</span>
                </div>
                <div class="flex space-x-8">
                    <a href="/"
                        class="relative text-blue-700 font-semibold hover:text-blue-900 transition after:block after:h-0.5 after:bg-blue-700 after:scale-x-0 hover:after:scale-x-100 after:transition-transform after:origin-left after:duration-300 after:mt-1">Home</a>
                    <a href="/upload"
                        class="relative text-blue-700 font-semibold hover:text-blue-900 transition after:block after:h-0.5 after:bg-blue-700 after:scale-x-0 hover:after:scale-x-100 after:transition-transform after:origin-left after:duration-300 after:mt-1">Upload
                        CSV</a>
                    <a href="#"
                        class="relative text-blue-700 font-semibold hover:text-blue-900 transition after:block after:h-0.5 after:bg-blue-700 after:scale-x-0 hover:after:scale-x-100 after:transition-transform after:origin-left after:duration-300 after:mt-1">About</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Form Upload -->
    <section class="py-16">
        <div class="max-w-lg mx-auto bg-white p-10 rounded-2xl shadow-2xl border border-blue-100">
            <h2 class="text-3xl font-bold mb-8 text-center text-blue-800">Upload Dataset</h2>
            <form method="POST" action="/proses" enctype="multipart/form-data" class="space-y-6">

                <!-- Loading Spinner -->
                <div id="loading" class="hidden text-center mt-4">
                    <div class="text-blue-500 font-medium animate-pulse">Sedang memproses data...</div>
                </div>

                <!-- File Input -->
                <div class="flex flex-col items-center justify-center gap-2">
                    <label
                        class="w-full flex flex-col items-center px-4 py-8 bg-blue-50 text-blue-700 rounded-lg border-2 border-dashed border-blue-300 cursor-pointer hover:bg-blue-100 transition">
                        <svg class="w-12 h-12 mb-2 text-blue-400" fill="none" stroke="currentColor" stroke-width="2"
                            viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M7 16v-4a5 5 0 0110 0v4M12 12v8m0 0l-3.5-3.5M12 20l3.5-3.5" />
                        </svg>
                        <span class="mb-2 text-base font-medium filename">
                            Drag & drop file here, or <span class="text-blue-600 underline">browse</span>
                        </span>
                        <input type="file" name="file" accept=".csv" required class="hidden file-input" />
                    </label>
                    <p class="text-xs text-blue-400 mt-1">Only .csv files are allowed. Max size: 5MB.</p>
                </div>

                <!-- Support & Confidence Inputs -->
                <div>
                    <label class="block mb-2 font-medium text-blue-700">Min Support</label>
                    <input type="text" name="min_support" value="0.02" required
                        class="w-full border border-blue-200 p-3 rounded focus:outline-none focus:ring-2 focus:ring-blue-400">
                </div>
                <div>
                    <label class="block mb-2 font-medium text-blue-700">Min Confidence</label>
                    <input type="text" name="min_confidence" value="0.4" required
                        class="w-full border border-blue-200 p-3 rounded focus:outline-none focus:ring-2 focus:ring-blue-400">
                </div>

                <!-- Submit Button -->
                <div>
                    <button type="submit"
                        class="w-full bg-blue-700 text-white p-3 rounded-full font-semibold hover:bg-blue-800 transition transform hover:scale-105 shadow">Proses</button>
                </div>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-white border-t border-blue-100 py-4 mt-12">
        <div class="max-w-7xl mx-auto text-center text-blue-700 text-sm">
            &copy; 2024 Data Mining App. All rights reserved.
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Validasi form dan tampilkan loading
        document.querySelector("form").addEventListener("submit", function (e) {
            const support = parseFloat(document.querySelector('input[name="min_support"]').value);
            const confidence = parseFloat(document.querySelector('input[name="min_confidence"]').value);

            if (isNaN(support) || support <= 0 || support >= 1) {
                alert("Minimum support harus antara 0 dan 1.");
                e.preventDefault();
                return;
            }

            if (isNaN(confidence) || confidence <= 0 || confidence > 1) {
                alert("Minimum confidence harus antara 0 dan 1.");
                e.preventDefault();
                return;
            }

            document.getElementById("loading").classList.remove("hidden");
        });

        // Tampilkan nama file yang dipilih
        document.querySelectorAll('.file-input').forEach(input => {
            input.addEventListener('change', function () {
                const label = this.closest('label');
                const span = label.querySelector('.filename');
                if (this.files.length > 0) {
                    span.innerHTML = `<b>${this.files[0].name}</b>`;
                }
            });
        });
    </script>

</body>

</html>
